<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ê°€ìƒë°œì „ì†Œ VPP</title>
    <link rel="manifest" href="manifest.json">
    <link href="https://fonts.googleapis.com/css2?family=Jua&family=Noto+Sans+KR:wght@500;700&display=swap" rel="stylesheet">
    <style>
        :root { --bg: #101418; --panel: #1c232e; --primary: #00d2ff; --accent: #ffc107; --danger: #ff5252; --success: #00e676; --text: #fff; }
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body { margin: 0; overflow: hidden; background: var(--bg); color: var(--text); font-family: 'Noto Sans KR', sans-serif; display: flex; flex-direction: column; height: 100vh; user-select: none; }

        /* ëª¨ë°”ì¼ ë ˆì´ì•„ì›ƒ ëŒ€ì‘ */
        @media (max-width: 768px) {
            #container { flex-direction: column !important; }
            #panel { width: 100% !important; height: 45% !important; order: 2; border-right: none !important; border-top: 1px solid #333; overflow-y: auto; }
            #map-area { height: 55% !important; order: 1; }
            header { height: 50px !important; padding: 0 15px !important; }
            .logo { font-size: 18px !important; }
            .slide-card { width: 90% !important; height: 80% !important; padding: 20px !important; }
            .slide-icon { font-size: 40px !important; }
            .slide-text-box { font-size: 14px !important; }
        }

        /* UI ìŠ¤íƒ€ì¼ */
        header { height: 60px; background: #151a24; border-bottom: 2px solid var(--primary); display: flex; align-items: center; justify-content: space-between; padding: 0 30px; z-index: 100; }
        .logo { font-family: 'Jua'; font-size: 24px; } .logo span { color: var(--primary); }
        .status-bar { display: flex; gap: 15px; align-items: center; font-size: 14px; }
        .coin-box { display: flex; align-items: center; gap: 5px; background: rgba(255,215,0,0.15); padding: 5px 12px; border-radius: 20px; border: 1px solid gold; }
        
        #container { display: flex; flex: 1; height: 100%; }
        #panel { width: 360px; background: var(--panel); border-right: 1px solid #333; padding: 15px; display: flex; flex-direction: column; gap: 10px; z-index: 10; overflow-y: auto; }
        .card { background: #252d3d; padding: 12px; border-radius: 10px; border: 1px solid #333; }
        .card-title { font-size: 14px; font-weight: bold; color: var(--primary); margin-bottom: 8px; border-bottom: 1px solid #444; padding-bottom: 4px; }
        
        /* ë²„íŠ¼ ê·¸ë¦¬ë“œ */
        .btn-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; }
        .ctrl-btn { padding: 12px; border: none; border-radius: 8px; font-weight: bold; color: #fff; opacity: 0.4; font-family: 'Jua'; font-size: 14px; background: #333; }
        .ctrl-btn.active { opacity: 1; transform: scale(1.02); box-shadow: 0 0 10px currentColor; }
        .c-charge { background: var(--danger); } .c-discharge { background: var(--success); }
        .c-dr { background: #9c27b0; grid-column: span 2; } .c-cut { background: #ff9800; grid-column: span 2; }

        #map-area { flex: 1; position: relative; background: radial-gradient(circle, #1b263b 0%, #0b0c15 100%); overflow: hidden; }
        canvas { display: block; width: 100%; height: 100%; }

        /* AI & Overlay */
        #ai-box { background: #fff; color: #000; padding: 10px; border-radius: 10px; border: 3px solid var(--primary); display: flex; align-items: center; gap: 10px; min-height: 40px; }
        #forecast-banner { position: absolute; top: 10px; left: 50%; transform: translateX(-50%); background: rgba(0,0,0,0.9); border: 2px solid var(--accent); color: var(--accent); padding: 10px 20px; border-radius: 30px; font-size: 16px; display: none; white-space: nowrap; z-index: 50; }
        
        /* Intro */
        #intro-overlay { position: fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.98); z-index:9999; display:flex; justify-content:center; align-items:center; }
        .slide-card { background:#fff; color:#333; width:90%; max-width:600px; height:400px; border-radius:15px; padding:20px; display:none; flex-direction:column; }
        .slide-card.active { display:flex; }
        .btn-ppt { background: #0054a6; color: #fff; border:none; padding:10px 20px; border-radius:8px; font-weight:bold; cursor:pointer; margin-top:auto; align-self:flex-end;}
        
        .res-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 5px; font-size: 12px; }
    </style>
</head>
<body>
    <div id="intro-overlay">
        <div class="slide-card active" id="s1">
            <h2 style="color:#0054a6">1. VPP êµìœ¡ ì‹œë®¬ë ˆì´í„°</h2>
            <div style="font-size:50px; text-align:center;">ğŸ“</div>
            <p>ë°˜ê°‘ìŠµë‹ˆë‹¤! ë³¸ ê²Œì„ì€ <b>ê°€ìƒë°œì „ì†Œ ìš´ì˜</b>ì„ í•™ìŠµí•˜ëŠ” ëª¨ë°”ì¼ ì›¹ì•±ì…ë‹ˆë‹¤.<br>í™”ë©´ì„ í„°ì¹˜í•˜ì—¬ ì§„í–‰í•˜ì„¸ìš”.</p>
            <button class="btn-ppt" onclick="nextS(2)">ë‹¤ìŒ</button>
        </div>
        <div class="slide-card" id="s2">
            <h2 style="color:#0054a6">2. ê²Œì„ ê·œì¹™</h2>
            <p>1. <b>ìë™ ì„±ì¥:</b> ì„¤ë¹„ëŠ” ì‹œê°„ì´ ì§€ë‚˜ë©´ ì €ì ˆë¡œ ëŠ˜ì–´ë‚©ë‹ˆë‹¤.<br>2. <b>ìœ„ê¸° ê´€ë¦¬:</b> ì „ê¸°ê°€ ë¶€ì¡±í•˜ë©´ [ë°©ì „], ë‚¨ìœ¼ë©´ [ì¶©ì „]í•˜ì„¸ìš”.<br>3. <b>AI íŒ:</b> ì¢Œì¸¡(í˜¹ì€ í•˜ë‹¨) AIì˜ ì¡°ì–¸ì„ ë”°ë¥´ì„¸ìš”.</p>
            <button class="btn-ppt" onclick="startGame()">í›ˆë ¨ ì‹œì‘ ğŸš€</button>
        </div>
    </div>

    <header>
        <div class="logo">âš¡ KEPCO</div>
        <div class="status-bar">
            <div class="coin-box">ğŸª™ <span id="ui-coin">0</span></div>
            <div>LV.<span id="ui-level">1</span></div>
            <div style="color:var(--primary)"><span id="ui-freq">60.0</span>Hz</div>
        </div>
    </header>

    <div id="container">
        <div id="map-area">
            <canvas id="gameCanvas"></canvas>
            <div id="forecast-banner">ğŸ“¢ ì˜ˆë³´: íƒœì–‘ê´‘ ë°œì „ ê¸‰ì¦!</div>
        </div>
        <div id="panel">
            <div id="ai-box">
                <span style="font-size:24px">ğŸ¤–</span><span id="ai-text" style="font-weight:bold; font-size:13px">ì¤€ë¹„ ì™„ë£Œ.</span>
            </div>
            <div class="card">
                <div class="card-title">ğŸ“Š ìˆ˜ê¸‰ í˜„í™©</div>
                <div class="res-grid">
                    <span>âš¡ê³µê¸‰: <span id="val-sup" style="color:var(--success)">0</span></span>
                    <span>ğŸ¢ìˆ˜ìš”: <span id="val-dem" style="color:var(--danger)">0</span></span>